# Next.js + Supabase ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸

ìµœì‹  Next.jsì™€ Supabaseë¥¼ í™œìš©í•œ í’€ìŠ¤íƒ ê°œë°œì„ ìœ„í•œ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ì…ë‹ˆë‹¤.

## ì£¼ìš” ê¸°ëŠ¥

- ğŸ” **Supabase Auth**: ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸ ì¸ì¦ ë° OAuth ì§€ì›
- ğŸ’¾ **Supabase Storage**: íŒŒì¼ ì—…ë¡œë“œ ë° ê´€ë¦¬
- ğŸ—ï¸ **Next.js ì•± ë¼ìš°í„°**: ìµœì‹  Next.js ì•± ë¼ìš°í„° êµ¬ì¡° ì‚¬ìš©
- ğŸ¨ **ShadcnUI + TailwindCSS**: í˜„ëŒ€ì ì´ê³  ì»¤ìŠ¤í„°ë§ˆì´ì§• ê°€ëŠ¥í•œ UI ì»´í¬ë„ŒíŠ¸
- ğŸŒ“ **ë‹¤í¬ ëª¨ë“œ**: ì‚¬ìš©ì ì„ í˜¸ì— ë”°ë¥¸ í…Œë§ˆ ì „í™˜ ì§€ì›
- ğŸ“± **ë°˜ì‘í˜• ë””ìì¸**: ëª¨ë°”ì¼ë¶€í„° ë°ìŠ¤í¬íƒ‘ê¹Œì§€ ìµœì í™”ëœ UI
- ğŸ” **SEO ìµœì í™”**: ë©”íƒ€ë°ì´í„°, êµ¬ì¡°í™”ëœ ë°ì´í„°, sitemap.xml, robots.txt ìë™ ìƒì„±
- ğŸ“ **ì„œë²„ ì•¡ì…˜**: Next.js ì„œë²„ ì•¡ì…˜ì„ í™œìš©í•œ í¼ ì²˜ë¦¬ ë° íŒŒì¼ ì—…ë¡œë“œ
- ğŸ”’ **ë³´í˜¸ëœ ë¼ìš°íŠ¸**: ì¸ì¦ ìƒíƒœì— ë”°ë¥¸ ë¼ìš°íŠ¸ ë³´í˜¸ êµ¬í˜„

## ê¸°ìˆ  ìŠ¤íƒ

- [Next.js](https://nextjs.org/)
- [Supabase](https://supabase.com/) (Auth, Storage)
- [TailwindCSS](https://tailwindcss.com/)
- [ShadcnUI](https://ui.shadcn.com/)
- [TypeScript](https://www.typescriptlang.org/)
- [Lucide Icons](https://lucide.dev/)

## ì‹œì‘í•˜ê¸°

### ì‚¬ì „ ìš”êµ¬ì‚¬í•­

- Node.js 18.17.0 ì´ìƒ
- pnpm 8.0.0 ì´ìƒ
- Supabase í”„ë¡œì íŠ¸ (Auth ë° Storage í™œì„±í™”)

### ì„¤ì¹˜

1. ì €ì¥ì†Œ í´ë¡ 

```bash
git clone https://github.com/your-username/boilerplate.git my-project
cd my-project
```

2. ì˜ì¡´ì„± ì„¤ì¹˜

```bash
pnpm install
```

3. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

`.env.example` íŒŒì¼ì„ `.env` íŒŒì¼ë¡œ ë³µì‚¬í•˜ê³  í•„ìš”í•œ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.

```bash
cp .env.example .env
```

`.env` íŒŒì¼ì— ë‹¤ìŒê³¼ ê°™ì´ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤:

```
NEXT_PUBLIC_SUPABASE_URL="https://project_id.supabase.co"
NEXT_PUBLIC_SUPABASE_ANON_KEY="your_supabase_anon_key"
NEXT_PUBLIC_STORAGE_BUCKET="your_storage_bucket_name" # ìŠ¤í† ë¦¬ì§€ ë²„í‚· ì´ë¦„

NEXT_PUBLIC_SITE_URL="http://localhost:3000" # ê°œë°œ í™˜ê²½ ë˜ëŠ” ë°°í¬ URL

SUPABASE_SERVICE_ROLE="your_supabase_service_role"
SUPABASE_DB_PASSWORD="your_supabase_db_password"

```

- `NEXT_PUBLIC_SUPABASE_URL`: Supabase í”„ë¡œì íŠ¸ URL
- `NEXT_PUBLIC_SUPABASE_ANON_KEY`: Supabase ìµëª… í‚¤
- `NEXT_PUBLIC_STORAGE_BUCKET`: Supabase ìŠ¤í† ë¦¬ì§€ ë²„í‚· ì´ë¦„ (ì˜ˆ: `test-bucket`)
- `NEXT_PUBLIC_SITE_URL`: ë°°í¬í•  ì‚¬ì´íŠ¸ URL (ê°œë°œ ì‹œ `http://localhost:3000`)
- `SUPABASE_SERVICE_ROLE`: Supabase ì„œë¹„ìŠ¤ ë¡¤ í‚¤ (ê´€ë¦¬ì ê¶Œí•œ)

**âš ï¸ ì¤‘ìš”: `SUPABASE_SERVICE_ROLE` ì‚¬ìš© ì‹œ ì£¼ì˜ì‚¬í•­**

`SUPABASE_SERVICE_ROLE` í‚¤ëŠ” Supabase í”„ë¡œì íŠ¸ì˜ ëª¨ë“  ë°ì´í„°ì— ì ‘ê·¼í•˜ê³  ëª¨ë“  RLS(Row Level Security) ì •ì±…ì„ ìš°íšŒí•  ìˆ˜ ìˆëŠ” ê´€ë¦¬ì ê¶Œí•œ í‚¤ì…ë‹ˆë‹¤.
ì´ í‚¤ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê²½ìš°ì—ë§Œ ë§¤ìš° ì‹ ì¤‘í•˜ê²Œ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤:

- ì„œë²„ ì¸¡ ë¡œì§ (ì˜ˆ: Next.js ì„œë²„ ì•¡ì…˜, API ë¼ìš°íŠ¸)
- ë³´ì•ˆëœ ì„œë²„ë¦¬ìŠ¤ í•¨ìˆ˜
- ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜ ë˜ëŠ” ê´€ë¦¬ ìŠ¤í¬ë¦½íŠ¸

**ì ˆëŒ€ë¡œ í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì½”ë“œë‚˜ ë¸Œë¼ìš°ì € í™˜ê²½ì— ì´ í‚¤ë¥¼ ë…¸ì¶œí•´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤.**
ë³´ì•ˆ ì¹¨í•´ ì‹œ ì‹¬ê°í•œ ë°ì´í„° ìœ ì¶œ ë° ì¡°ì‘ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì¼ë°˜ì ì¸ ì‚¬ìš©ì ë°ì´í„° ì ‘ê·¼ì—ëŠ” í•­ìƒ ìµëª… í‚¤(`NEXT_PUBLIC_SUPABASE_ANON_KEY`)ë¥¼ ì‚¬ìš©í•˜ê³  RLS ì •ì±…ì„ í†µí•´ ë°ì´í„° ì ‘ê·¼ì„ ì œì–´í•˜ì„¸ìš”.

- `SUPABASE_DB_PASSWORD`: Supabase ë°ì´í„°ë² ì´ìŠ¤ ë¹„ë°€ë²ˆí˜¸

### ê°œë°œ ì„œë²„ ì‹¤í–‰

```bash
pnpm dev
```

ì´ì œ ë¸Œë¼ìš°ì €ì—ì„œ [http://localhost:3000](http://localhost:3000)ìœ¼ë¡œ ì ‘ì†í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## Supabase ì„¤ì •

### 1. Supabase í”„ë¡œì íŠ¸ ìƒì„±

1. [Supabase](https://supabase.com/)ì— ë¡œê·¸ì¸í•˜ê³  ìƒˆ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
2. í”„ë¡œì íŠ¸ ìƒì„± í›„ í”„ë¡œì íŠ¸ ì„¤ì •ì—ì„œ API URLê³¼ ìµëª… í‚¤ë¥¼ ì°¾ì•„ `.env` íŒŒì¼ì— ì„¤ì •í•©ë‹ˆë‹¤.

### 2. ì¸ì¦ ì„¤ì •

1. Supabase ëŒ€ì‹œë³´ë“œì—ì„œ Authentication > Settingsë¡œ ì´ë™í•©ë‹ˆë‹¤.
2. Site URLì„ ì„¤ì •í•©ë‹ˆë‹¤ (ë°°í¬ëœ URL ë˜ëŠ” ê°œë°œ í™˜ê²½ì—ì„œëŠ” `http://localhost:3000`).
3. OAuth ì œê³µì—…ì²´ë¥¼ ì„¤ì •í•˜ë ¤ë©´ Authentication > Providersë¡œ ì´ë™í•˜ì—¬ ì›í•˜ëŠ” ì œê³µì—…ì²´ë¥¼ í™œì„±í™”í•©ë‹ˆë‹¤.
4. Redirect URLsì— `{SITE_URL}/auth/callback`ì„ ì¶”ê°€í•©ë‹ˆë‹¤.

### 3. ìŠ¤í† ë¦¬ì§€ ì„¤ì •

1. Supabase ëŒ€ì‹œë³´ë“œì—ì„œ Storageë¡œ ì´ë™í•©ë‹ˆë‹¤.
2. "Create a new bucket"ì„ í´ë¦­í•˜ì—¬ ìƒˆ ë²„í‚·ì„ ìƒì„±í•©ë‹ˆë‹¤.
3. ë²„í‚· ì´ë¦„ì„ `.env` íŒŒì¼ì˜ `NEXT_PUBLIC_STORAGE_BUCKET`ì— ì„¤ì •í•œ ì´ë¦„ê³¼ ë™ì¼í•˜ê²Œ ì§€ì •í•©ë‹ˆë‹¤ (ì˜ˆ: `test-bucket`).
4. **Public access**ë¥¼ í™œì„±í™”í•©ë‹ˆë‹¤. (ì´ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ëŠ” ê³µê°œ ë²„í‚·ì„ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.)
5. (ì„ íƒ ì‚¬í•­) ìŠ¤í† ë¦¬ì§€ ì •ì±…(Policies)ì„ ì„¤ì •í•˜ì—¬ íŒŒì¼ ì ‘ê·¼ ê¶Œí•œì„ ì„¸ë°€í•˜ê²Œ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ ê³µê°œ ë²„í‚·ì€ ëª¨ë“  ì‚¬ìš©ìê°€ íŒŒì¼ì„ ì½ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŒŒì¼ ì—…ë¡œë“œ ë° ì‚­ì œëŠ” ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ì˜ ì„œë²„ ì•¡ì…˜ì„ í†µí•´ ì²˜ë¦¬ë©ë‹ˆë‹¤.

## ìŠ¤í† ë¦¬ì§€ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­ (Storage Security Considerations)

ì´ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ëŠ” Supabase Storageë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ ì—…ë¡œë“œ ë° ê´€ë¦¬ë¥¼ ì§€ì›í•©ë‹ˆë‹¤. ê¸°ë³¸ ì„¤ì •ì—ì„œëŠ” í¸ì˜ë¥¼ ìœ„í•´ ê³µê°œ(public) ë²„í‚·ì„ ì‚¬ìš©í•˜ë„ë¡ ì•ˆë‚´í•˜ê³  ìˆìŠµë‹ˆë‹¤. ê³µê°œ ë²„í‚·ì€ ë²„í‚· ë‚´ì˜ ëª¨ë“  ê°ì²´ì— ëŒ€í•´ ê³µê°œì ì¸ ì½ê¸° ì ‘ê·¼ì„ í—ˆìš©í•©ë‹ˆë‹¤.

### ê³µê°œ ë²„í‚·ì˜ ì˜ë¯¸

- **ì½ê¸° ì ‘ê·¼**: ë²„í‚·ì´ ê³µê°œë¡œ ì„¤ì •ë˜ë©´, í•´ë‹¹ ë²„í‚· ë‚´ íŒŒì¼ì˜ URLì„ ì•„ëŠ” ì‚¬ëŒì€ ëˆ„êµ¬ë‚˜ íŒŒì¼ì„ ì½ê±°ë‚˜ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¸ì¦ì´ë‚˜ ì¶”ê°€ì ì¸ ê¶Œí•œ í™•ì¸ì´ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
- **ì“°ê¸°/ì‚­ì œ ì ‘ê·¼**: ì´ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ì—ì„œëŠ” íŒŒì¼ ì—…ë¡œë“œ, ìˆ˜ì •, ì‚­ì œëŠ” ì¸ì¦ëœ ì‚¬ìš©ìì— í•œí•´ ì„œë²„ ì•¡ì…˜(`src/actions/storage.ts`)ì„ í†µí•´ì„œë§Œ ì´ë£¨ì–´ì§€ë„ë¡ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì§ì ‘ì ì¸ í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì“°ê¸° ì ‘ê·¼ì„ ë°©ì§€í•˜ì—¬ ê¸°ë³¸ì ì¸ ë³´ì•ˆì„ ì œê³µí•©ë‹ˆë‹¤.

### ìŠ¤í† ë¦¬ì§€ ì ‘ê·¼ ì œì–´ ê°•í™” (RLS ì •ì±… í™œìš©)

ëª¨ë“  ì‚¬ìš©ìì—ê²Œ íŒŒì¼ì„ ê³µê°œí•˜ê³  ì‹¶ì§€ ì•Šê±°ë‚˜, ì‚¬ìš©ìë³„ ë˜ëŠ” ì¡°ê±´ë³„ë¡œ íŒŒì¼ ì ‘ê·¼ ê¶Œí•œì„ ì„¸ë°€í•˜ê²Œ ì œì–´í•´ì•¼ í•˜ëŠ” ê²½ìš° Supabaseì˜ RLS(Row Level Security) ì •ì±…ì„ ìŠ¤í† ë¦¬ì§€ì— ì ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

**RLS ì •ì±…ì„ ì‚¬ìš©í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ê·œì¹™ì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:**

- ì‚¬ìš©ìëŠ” ìì‹ ì˜ íŒŒì¼ë§Œ ë³´ê±°ë‚˜ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- íŠ¹ì • ì—­í• ì„ ê°€ì§„ ì‚¬ìš©ìë§Œ íŠ¹ì • í´ë”ì˜ íŒŒì¼ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- íŠ¹ì • ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” íŒŒì¼ë§Œ ê³µê°œì ìœ¼ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•˜ê²Œ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**RLS ì •ì±… ì„¤ì • ë°©ë²•:**

1.  **ë²„í‚·ì„ ë¹„ê³µê°œ(private)ë¡œ ì„¤ì •**: Supabase ëŒ€ì‹œë³´ë“œì—ì„œ í•´ë‹¹ ìŠ¤í† ë¦¬ì§€ ë²„í‚·ì˜ "Public access"ë¥¼ ë¹„í™œì„±í™”í•©ë‹ˆë‹¤.
2.  **ìŠ¤í† ë¦¬ì§€ ì •ì±…(Policies) ìƒì„±**: Supabase ëŒ€ì‹œë³´ë“œì˜ "Storage" > "Policies" ì„¹ì…˜ì—ì„œ í…Œì´ë¸”ì— RLS ì •ì±…ì„ ì„¤ì •í•˜ë“¯ì´ ìŠ¤í† ë¦¬ì§€ ê°ì²´ì— ëŒ€í•œ ì •ì±…ì„ ì‘ì„±í•©ë‹ˆë‹¤.

    - `storage.objects` í…Œì´ë¸”ì— ëŒ€í•´ `SELECT`, `INSERT`, `UPDATE`, `DELETE` ê¶Œí•œì— ëŒ€í•œ ì •ì±…ì„ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    - ì˜ˆë¥¼ ë“¤ì–´, ì‚¬ìš©ìê°€ ìì‹ ì˜ `user_id`ì™€ ì¼ì¹˜í•˜ëŠ” í´ë” ë‚´ì˜ íŒŒì¼ë§Œ ì½ì„ ìˆ˜ ìˆë„ë¡ í•˜ë ¤ë©´ `SELECT` ì •ì±…ì„ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
      ```sql
      -- ì‚¬ìš©ìëŠ” ìì‹ ì˜ user_idì™€ ì´ë¦„ì´ ê°™ì€ í´ë” ë‚´ì˜ íŒŒì¼ë§Œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      CREATE POLICY "User can view own files"
      ON storage.objects FOR SELECT
      USING ( auth.uid()::text = (storage.foldername(name))[1] );
      -- ì°¸ê³ : ìœ„ ì •ì±…ì€ íŒŒì¼ ê²½ë¡œì˜ ì²« ë²ˆì§¸ í´ë” ì´ë¦„ì´ user_idì™€ ê°™ë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.
      -- ì˜ˆ: /user_id_123/image.png
      ```
    - íŒŒì¼ ì—…ë¡œë“œ ì‹œ `INSERT` ì •ì±…ì€ ì‚¬ìš©ìê°€ íŠ¹ì • ê²½ë¡œì—ë§Œ ì—…ë¡œë“œí•˜ë„ë¡ ì œí•œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      ```sql
      -- ì‚¬ìš©ìëŠ” ìì‹ ì˜ user_idì™€ ì´ë¦„ì´ ê°™ì€ í´ë”ì—ë§Œ íŒŒì¼ì„ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      CREATE POLICY "User can upload to own folder"
      ON storage.objects FOR INSERT
      WITH CHECK ( auth.uid()::text = (storage.foldername(name))[1] );
      ```

3.  **ì„œë²„ ì•¡ì…˜ í™•ì¸**: `src/actions/storage.ts`ì˜ íŒŒì¼ ê´€ë ¨ ë¡œì§(íŠ¹íˆ íŒŒì¼ URL ìƒì„± ë˜ëŠ” ì ‘ê·¼)ì´ ë¹„ê³µê°œ ë²„í‚· ë° RLS ì •ì±…ê³¼ í˜¸í™˜ë˜ëŠ”ì§€ í™•ì¸í•´ì•¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë¹„ê³µê°œ íŒŒì¼ì— ì ‘ê·¼í•˜ë ¤ë©´ Supabase í´ë¼ì´ì–¸íŠ¸ì—ì„œ `createSignedUrl`ê³¼ ê°™ì€ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ì‹œê°„ ë™ì•ˆë§Œ ìœ íš¨í•œ URLì„ ìƒì„±í•´ì•¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ì˜ `src/utils/supabase/storage.ts`ì— ìˆëŠ” `getPublicUrl`ì€ ê³µê°œ ë²„í‚·ì„ ê°€ì •í•˜ë¯€ë¡œ, ë¹„ê³µê°œ ë²„í‚· ì‚¬ìš© ì‹œì—ëŠ” `createSignedUrl` ë“±ìœ¼ë¡œ ëŒ€ì²´í•´ì•¼ í•©ë‹ˆë‹¤.

**ìì„¸í•œ ì •ë³´ëŠ” Supabase ê³µì‹ ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì„¸ìš”:**

- [Supabase Storage ì ‘ê·¼ ì œì–´](https://supabase.com/docs/guides/storage/security/access-control)
- [Supabase Storage RLS ì •ì±… ì˜ˆì‹œ](https://supabase.com/docs/guides/storage/security/rls-policies-examples)

ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìš”êµ¬ì‚¬í•­ì— ë§ì¶° ìŠ¤í† ë¦¬ì§€ ë³´ì•ˆ ì„¤ì •ì„ ì ì ˆíˆ êµ¬ì„±í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.

## ë°ì´í„°ë² ì´ìŠ¤ íƒ€ì… ìƒì„± (Type Generation)

ì´ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ëŠ” Supabase ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆë¡œë¶€í„° TypeScript íƒ€ì…ì„ ìƒì„±í•˜ì—¬ ì½”ë“œ ì•ˆì •ì„±ê³¼ ê°œë°œì ê²½í—˜ì„ í–¥ìƒì‹œí‚¤ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤. ìƒì„±ëœ íƒ€ì…ì€ `src/types/database.types.ts` íŒŒì¼ì— ì €ì¥ë©ë‹ˆë‹¤.

### 1. Supabase CLI ì„¤ì¹˜ ë° ë¡œê·¸ì¸

ì•„ì§ Supabase CLIë¥¼ ì„¤ì¹˜í•˜ì§€ ì•Šì•˜ë‹¤ë©´, ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ ì„¤ì¹˜í•˜ì„¸ìš”:

```bash
pnpm install supabase --save-dev
```

ë˜ëŠ” ì „ì—­ìœ¼ë¡œ ì„¤ì¹˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```bash
pnpm install -g supabase
```

ì„¤ì¹˜ í›„ Supabaseì— ë¡œê·¸ì¸í•©ë‹ˆë‹¤:

```bash
pnpx supabase login
```

### 2. í”„ë¡œì íŠ¸ ID í™•ì¸ ë° ì„¤ì •

Supabase í”„ë¡œì íŠ¸ ëŒ€ì‹œë³´ë“œì—ì„œ í”„ë¡œì íŠ¸ IDë¥¼ í™•ì¸í•˜ì„¸ìš”. (URLì´ `https://<project_id>.supabase.co` í˜•ì‹ì¸ ê²½ìš° `<project_id>` ë¶€ë¶„ì…ë‹ˆë‹¤.)

`package.json` íŒŒì¼ì˜ `scripts` ì„¹ì…˜ì— ìˆëŠ” `supabase:types` ëª…ë ¹ì–´ë¥¼ ìˆ˜ì •í•˜ì—¬ `YOUR_PROJECT_ID_HERE` ë¶€ë¶„ì„ ì‹¤ì œ í”„ë¡œì íŠ¸ IDë¡œ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤.

ì˜ˆì‹œ:

```json
// package.json
"scripts": {
  // ... ë‹¤ë¥¸ ìŠ¤í¬ë¦½íŠ¸ë“¤ ...
  "supabase:types": "supabase gen types typescript --project-id ì‹¤ì œí”„ë¡œì íŠ¸ID > src/types/database.types.ts"
},
```

ë˜ëŠ”, í™˜ê²½ ë³€ìˆ˜ `SUPABASE_PROJECT_ID`ë¥¼ ì„¤ì •í•˜ê³  ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:
`"supabase:types": "supabase gen types typescript --project-id $SUPABASE_PROJECT_ID > src/types/database.types.ts"`

### 3. íƒ€ì… ìƒì„± ì‹¤í–‰

ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ íƒ€ì…ì„ ìƒì„±í•©ë‹ˆë‹¤:

```bash
pnpm supabase:types
```

(ë˜ëŠ” `npm run supabase:types` / `yarn supabase:types`)

ì´ ëª…ë ¹ì–´ëŠ” `src/types/database.types.ts` íŒŒì¼ì„ Supabase ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë®ì–´ì”ë‹ˆë‹¤.
ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì‹œ (í…Œì´ë¸”, ì»¬ëŸ¼, í•¨ìˆ˜ ë“± ì¶”ê°€/ìˆ˜ì •) ì´ ëª…ë ¹ì–´ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•˜ì—¬ íƒ€ì…ì„ ìµœì‹  ìƒíƒœë¡œ ìœ ì§€í•˜ì„¸ìš”.

### 4. ìƒì„±ëœ íƒ€ì… í™œìš©

ìƒì„±ëœ íƒ€ì…ì€ Supabase í´ë¼ì´ì–¸íŠ¸ì™€ í•¨ê»˜ ì‚¬ìš©í•˜ì—¬ ì¿¼ë¦¬ ê²°ê³¼ ë° ì…ë ¥ì— ëŒ€í•œ íƒ€ì… ì•ˆì „ì„±ì„ í™•ë³´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```typescript
// ì˜ˆì‹œ: Supabase í´ë¼ì´ì–¸íŠ¸ì™€ íƒ€ì… í•¨ê»˜ ì‚¬ìš©í•˜ê¸°
import { createServerSupabaseClient } from "@/utils/supabase/server";
import type { Database } from "@/types/database.types"; // ìƒì„±ëœ íƒ€ì… import

async function getUserProfile(userId: string) {
  const supabase = await createServerSupabaseClient(); // íƒ€ì… ì§€ì •ì€ createServerSupabaseClient<Database>() ì™€ ê°™ì´ ê°€ëŠ¥
  const { data, error } = await supabase
    .from("profiles") // 'profiles' í…Œì´ë¸”ì´ ìˆë‹¤ê³  ê°€ì •
    .select("*")
    .eq("id", userId)
    .single<Database["public"]["Tables"]["profiles"]["Row"]>(); // Row íƒ€ì… ì‚¬ìš©

  if (error) throw error;
  return data;
}
```

ì´ì™€ ê°™ì´ íƒ€ì…ì„ í™œìš©í•˜ë©´ ê°œë°œ ì¤‘ ì‹¤ìˆ˜ë¥¼ ì¤„ì´ê³  ìë™ ì™„ì„±ì„ í†µí•´ ìƒì‚°ì„±ì„ ë†’ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
`src/types/schema.ts`ì˜ Zod ìŠ¤í‚¤ë§ˆì™€ í•¨ê»˜ ì‚¬ìš©í•˜ê±°ë‚˜, Zod ìŠ¤í‚¤ë§ˆë¥¼ ìƒì„±ëœ DB íƒ€ì…ìœ¼ë¡œë¶€í„° íŒŒìƒì‹œí‚¤ëŠ” ë°©ë²•ë„ ê³ ë ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
src/
â”œâ”€â”€ actions/                # Next.js ì„œë²„ ì•¡ì…˜ (auth.ts, storage.ts)
â”œâ”€â”€ app/                    # Next.js ì•± ë¼ìš°í„°
â”‚   â”œâ”€â”€ auth/               # ì¸ì¦ ê´€ë ¨ ë¼ìš°íŠ¸ (callback, error)
â”‚   â”œâ”€â”€ login/              # ë¡œê·¸ì¸ í˜ì´ì§€ (layout.tsx, page.tsx)
â”‚   â”œâ”€â”€ profile/            # í”„ë¡œí•„ í˜ì´ì§€ (layout.tsx, page.tsx)
â”‚   â”œâ”€â”€ globals.css         # ì „ì—­ ìŠ¤íƒ€ì¼
â”‚   â”œâ”€â”€ layout.tsx          # ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ
â”‚   â”œâ”€â”€ page.tsx            # í™ˆí˜ì´ì§€ (íŒŒì¼ ì—…ë¡œë“œ/ë¦¬ìŠ¤íŠ¸)
â”‚   â”œâ”€â”€ favicon.ico         # íŒŒë¹„ì½˜
â”‚   â”œâ”€â”€ manifest.ts         # PWA ë§¤ë‹ˆí˜ìŠ¤íŠ¸
â”‚   â”œâ”€â”€ not-found.tsx       # 404 í˜ì´ì§€
â”‚   â”œâ”€â”€ robots.ts           # robots.txt ìƒì„±
â”‚   â””â”€â”€ sitemap.ts          # sitemap.xml ìƒì„±
â”œâ”€â”€ components/             # ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ auth/               # ì¸ì¦ UI ì»´í¬ë„ŒíŠ¸ (buttons.tsx ë“±)
â”‚   â”œâ”€â”€ nav/                # ë„¤ë¹„ê²Œì´ì…˜ ì»´í¬ë„ŒíŠ¸ (navbar.tsx ë“±)
â”‚   â”œâ”€â”€ seo/                # SEO ê´€ë ¨ ì»´í¬ë„ŒíŠ¸ (JsonLd.tsx)
â”‚   â”œâ”€â”€ storage/            # ìŠ¤í† ë¦¬ì§€ ê´€ë ¨ UI ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ file-uploader.tsx # íŒŒì¼ ì—…ë¡œë“œ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â””â”€â”€ file-list.tsx     # íŒŒì¼ ëª©ë¡ ì»´í¬ë„ŒíŠ¸
â”‚   â””â”€â”€ ui/                 # Shadcn UI ì»´í¬ë„ŒíŠ¸ (button.tsx, input.tsx ë“±)
â”œâ”€â”€ hooks/                  # ì»¤ìŠ¤í…€ í›… (use-mobile.ts)
â”œâ”€â”€ lib/                    # ë¼ì´ë¸ŒëŸ¬ë¦¬ ìœ í‹¸ë¦¬í‹° (utils.ts - Shadcn)
â”œâ”€â”€ middleware.ts           # Next.js ë¯¸ë“¤ì›¨ì–´ (ë¼ìš°íŠ¸ ë³´í˜¸)
â”œâ”€â”€ types/                  # TypeScript íƒ€ì… ì •ì˜ (schema.ts)
â””â”€â”€ utils/                  # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
    â”œâ”€â”€ seo/                # SEO ìœ í‹¸ë¦¬í‹° (constants.ts, metadata.ts)
    â””â”€â”€ supabase/           # Supabase í´ë¼ì´ì–¸íŠ¸ (client.ts, server.ts, middleware.ts, storage.ts)
```

## ì£¼ìš” ê¸°ëŠ¥ ì‚¬ìš©ë²•

## ë¼ìš°íŠ¸ ë³´í˜¸

`src/middleware.ts`ëŠ” `src/utils/supabase/middleware.ts`ì˜ `updateSession` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ë¼ìš°íŠ¸ ë³´í˜¸ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.
ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìê°€ ë³´í˜¸ëœ ê²½ë¡œì— ì ‘ê·¼í•˜ë ¤ê³  í•˜ë©´ ë¡œê·¸ì¸ í˜ì´ì§€(`/login`)ë¡œ ë¦¬ë””ë ‰ì…˜ë©ë‹ˆë‹¤.

ë³´í˜¸í•  ê²½ë¡œëŠ” `src/utils/supabase/middleware.ts` íŒŒì¼ ë‚´ì˜ `updateSession` í•¨ìˆ˜ ì•ˆì— ìˆëŠ” `protectedRoutes` ë°°ì—´ì„ ìˆ˜ì •í•˜ì—¬ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì˜ˆì‹œ:

```typescript
// src/utils/supabase/middleware.ts

// ... ì½”ë“œ ìƒë‹¨ ...

export async function updateSession(request: NextRequest) {
  // ... ìƒëµ ...

  // ì‚¬ìš©ìê°€ ìˆ˜ì •í•  ìˆ˜ ìˆëŠ” ë³´í˜¸ëœ ë¼ìš°íŠ¸ ëª©ë¡
  // ì˜ˆ: const protectedRoutes = ['/profile', '/settings', '/dashboard'];
  const protectedRoutes = ["/profile"]; // ì´ ë°°ì—´ì„ ìˆ˜ì •í•˜ì—¬ ë³´í˜¸í•  ê²½ë¡œë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ ë³€ê²½í•˜ì„¸ìš”.

  // í˜„ì¬ ê²½ë¡œê°€ ë³´í˜¸ëœ ë¼ìš°íŠ¸ì¸ì§€ í™•ì¸
  const isProtectedRoute = protectedRoutes.some((route) =>
    path.startsWith(route),
  );

  // ì¸ì¦ì´ í•„ìš”í•œ í˜ì´ì§€ì— ì ‘ê·¼ ì‹œ ë¡œê·¸ì¸ì´ ë˜ì–´ ìˆì§€ ì•Šìœ¼ë©´ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰ì…˜
  if (isProtectedRoute && !user) {
    return NextResponse.redirect(new URL("/login", request.url));
  }

  // ... ìƒëµ ...
}
```

ê¸°ë³¸ì ìœ¼ë¡œ `/profile` ê²½ë¡œê°€ ë³´í˜¸ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
í•„ìš”ì— ë”°ë¼ ì´ ë°°ì—´ì— ê²½ë¡œë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ ê¸°ì¡´ ê²½ë¡œë¥¼ ìˆ˜ì •í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì ‘ê·¼ ì œì–´ë¥¼ ê´€ë¦¬í•˜ì„¸ìš”.
ê²½ë¡œëŠ” `startsWith`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë§¤ì¹­ë˜ë¯€ë¡œ, `/admin`ì„ ì¶”ê°€í•˜ë©´ `/admin/users`, `/admin/settings` ë“± í•˜ìœ„ ê²½ë¡œë„ ëª¨ë‘ ë³´í˜¸ë©ë‹ˆë‹¤.

### ì¸ì¦ ì»´í¬ë„ŒíŠ¸

ë¡œê·¸ì¸ ë° íšŒì›ê°€ì… ê¸°ëŠ¥ì€ `src/app/login/page.tsx`ì— êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ í˜ì´ì§€ëŠ” ì„œë²„ ì•¡ì…˜(`src/actions/auth.ts`)ì„ ì‚¬ìš©í•˜ì—¬ ì¸ì¦ ë¡œì§ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.

### íŒŒì¼ ì—…ë¡œë“œ ë° ê´€ë¦¬

íŒŒì¼ ì—…ë¡œë“œ ë° ëª©ë¡ í‘œì‹œëŠ” í™ˆí˜ì´ì§€(`src/app/page.tsx`)ì—ì„œ ì²˜ë¦¬ë©ë‹ˆë‹¤.

- `src/components/storage/file-uploader.tsx`: íŒŒì¼ ì—…ë¡œë“œë¥¼ ìœ„í•œ UI ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤. `src/app/page.tsx`ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤.
- `src/components/storage/file-list.tsx`: ì—…ë¡œë“œëœ íŒŒì¼ ëª©ë¡ì„ í‘œì‹œí•˜ê¸° ìœ„í•œ UI ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤. `src/app/page.tsx`ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤.
- íŒŒì¼ ì—…ë¡œë“œëŠ” `src/actions/storage.ts` ì„œë²„ ì•¡ì…˜ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
- Supabase Storage ìœ í‹¸ë¦¬í‹°ëŠ” `src/utils/supabase/storage.ts`ì— ìˆìŠµë‹ˆë‹¤.

### SEO ìµœì í™”

`src/utils/seo` ë””ë ‰í† ë¦¬ì˜ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ í˜ì´ì§€ë³„ ë©”íƒ€ë°ì´í„°ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```typescript
// í˜ì´ì§€ ë©”íƒ€ë°ì´í„° ì„¤ì • ì˜ˆì‹œ
import { createMetadata } from "@/utils/seo/metadata";

export const metadata = createMetadata({
  title: "í˜ì´ì§€ ì œëª©",
  description: "í˜ì´ì§€ ì„¤ëª…",
  noIndex: false, // ê²€ìƒ‰ ì—”ì§„ ìƒ‰ì¸ ì—¬ë¶€
});
```

## Vercel ë°°í¬

ì´ í”„ë¡œì íŠ¸ëŠ” [Vercel](https://vercel.com/)ì— ì‰½ê²Œ ë°°í¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

1. GitHub ì €ì¥ì†Œë¥¼ Vercelì— ì—°ê²°í•©ë‹ˆë‹¤.
2. í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. (`.env` íŒŒì¼ ë‚´ìš© ì°¸ê³ )
3. ë°°í¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.

## ê³ ê¸‰ ê¸°ëŠ¥ (Advanced Features)

### MCP(Model Context Protocol) ì„¤ì •

ì´ ì„¹ì…˜ì€ AI ê¸°ë°˜ ê°œë°œ ë„êµ¬ì™€ì˜ í†µí•©ì„ ìœ„í•œ ê³ ê¸‰ ì„¤ì •ì…ë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ ì‚¬ìš©ìì—ê²ŒëŠ” í•„ìš”í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ í”„ë¡œì íŠ¸ëŠ” AI ê¸°ë°˜ ê°œë°œ ë„êµ¬ë¥¼ ìœ„í•œ MCP ì„œë²„ ì„¤ì •ì„ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. `.cursor/mcp.json` íŒŒì¼ì—ì„œ ì„¤ì •ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```json
{
  "mcpServers": {
    "sequential-thinking": {
      "command": "bunx",
      "args": ["@modelcontextprotocol/server-sequential-thinking"]
    },
    "context7": {
      "command": "bunx",
      "args": ["@upstash/context7-mcp"]
    },
    "supabase": {
      "command": "bunx",
      "args": [
        "@supabase/mcp-server-supabase@latest",
        "--access-token",
        // ë³´ì•ˆ ì£¼ì˜: Supabase ì•¡ì„¸ìŠ¤ í† í°ì€ ë¯¼ê°í•œ ì •ë³´ì…ë‹ˆë‹¤. ì´ í† í°ì€ Supabase í”„ë¡œì íŠ¸ì— ëŒ€í•œ ê´‘ë²”ìœ„í•œ ì ‘ê·¼ ê¶Œí•œì„ ë¶€ì—¬í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•´ì•¼ í•˜ë©°, ê³µê°œ ì €ì¥ì†Œë‚˜ í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì½”ë“œì— ì§ì ‘ í¬í•¨í•´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤. í™˜ê²½ ë³€ìˆ˜ë‚˜ ì•ˆì „í•œ ì €ì¥ì†Œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.
        "your_supabase_access_token" // ì‹¤ì œ Supabase ì•¡ì„¸ìŠ¤ í† í°ìœ¼ë¡œ ë³€ê²½
      ]
    }
  }
}
```

Supabase MCP ì„œë²„ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ `your_supabase_access_token`ì„ ì‹¤ì œ ì•¡ì„¸ìŠ¤ í† í°ìœ¼ë¡œ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤.
